# BDUI CLI Simplification Plan

## Objectives
- Replace ad-hoc project wiring with a first-class `bdui` CLI that exposes `run` and `init` commands.
- Ensure sample apps (e.g., `react-sample`) and downstream consumers only need `bdui run` to execute tests.
- Keep BDUI-required behavior intact while allowing safe user customization.

## Key Requirements
1. **Single command test execution**: `bdui run` handles config loading, step registration, and cucumber invocation.
2. **New CLI binary**: Implemented inside the `behavior-driven-ui` package, exported via existing `bin` field.
3. **Bundled core steps**: Users never copy BDUI-provided steps; CLI always registers them automatically.
4. **Centralized runtime orchestration**: Logic currently in `apps/react-sample/cucumber.ts` migrates into the CLI.
5. **Extensible steps**: Users may add step files by convention (e.g., `bdui/steps/**/*.{ts,js}`) or by providing globs in config.
6. **Protected cucumber options**: Users may supply overrides, but CLI validates/filters them to avoid conflicts with BDUI requirements.
7. **Project scaffolding**: `bdui init` creates baseline directories, config, and scripts (“schafoled”) to prepare a project.

## Implementation Outline
- **CLI Structure**
  - Use `commander` for command parsing.
  - Support `bdui run [options]` invoking `runBduiFeatures` with merged defaults.
  - Support `bdui init` to generate config, directories, and optional sample files.
  - Handle TS/ESM loading (register `tsx`/loaders) before importing user steps.
- **Configuration**
  - Introduce `bdui.config.(ts|js)` schema (validated with `zod`).
  - Defaults: `features/**/*.feature`, `bdui/steps/**/*.{ts,js}`.
  - Allow explicit cucumber options but sanitize conflicting fields (e.g., keep `strict`, enforce core loaders).
- **Step Loading**
  - Always register BDUI core step library.
  - Discover additional steps via conventions or config globs and require/import them dynamically.
- **Sample App Updates**
  - Remove `apps/react-sample/cucumber.ts` and related scripts.
  - Replace test script with `bdui run`.
  - Provide scaffolded files generated by `bdui init` (or document how to regenerate).
- **Build & Packaging**
  - Update `tsup.config.ts` to emit CLI bundle (`dist/cli.js` + `.mjs`).
  - Ensure package exports/binaries reference compiled output.
- **Documentation & Tests**
  - Add docs covering CLI usage, init workflow, configuration reference, migration notes.
  - Add unit/integration tests verifying CLI commands, config merging, and step discovery.

## Next Steps (once in implementation mode)
1. Implement CLI source files and tsup build wiring.
2. Create configuration loader and validation utilities.
3. Update `react-sample` to rely solely on the new CLI.
4. Add automated tests for CLI behavior.
5. Refresh documentation and sample instructions.
